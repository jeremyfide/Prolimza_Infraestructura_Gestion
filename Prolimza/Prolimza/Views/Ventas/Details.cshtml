@model Prolimza.Models.Venta

<div class="geex-content__double-column mb-40">
    <div class="geex-content__section geex-content__market">
        <div class="geex-content__section__header">
            <h4 class="geex-content__section__header__title">Detalle de la Venta</h4>
        </div>
        <div class="geex-content__section__content geex-content__market__content">
            <div class="geex-content__market__single">
                <div class="geex-content__market__single__wrapper">
                    <div class="geex-content__market__single__content">

                        <h4 class="geex-content__market__single__title">@Html.DisplayFor(model => model.CodigoIngreso)</h4>
                        <p class="geex-content__market__single__subtitle">@Html.DisplayNameFor(model => model.CodigoIngreso)</p>

                        <h4 class="geex-content__market__single__title">@Html.DisplayFor(model => model.FechaVenta)</h4>
                        <p class="geex-content__market__single__subtitle">@Html.DisplayNameFor(model => model.FechaVenta)</p>

                        <h4 class="geex-content__market__single__title">@Html.DisplayFor(model => model.Usuario.Nombre)</h4>
                        <p class="geex-content__market__single__subtitle">@Html.DisplayNameFor(model => model.Usuario)</p>

                        @if (Model.DetallesVenta?.Any() == true)
                        {
                            <h4 class="geex-content__market__single__title mt-4">Productos Vendidos</h4>
                            <ul>
                                @foreach (var item in Model.DetallesVenta)
                                {
                                    <li class="mb-2">
                                        @item.Producto?.NombreProducto — @item.Cantidad unidades
                                    </li>
                                }
                            </ul>
                        }
                        else
                        {
                            <p>No se registraron productos en esta venta.</p>
                        }

                        @if (Model.HistorialesEstadoVenta?.Any() == true)
                        {
                            <h4 class="geex-content__market__single__title mt-4">Historial de Estado</h4>
                            <ul>
                                @foreach (var estado in Model.HistorialesEstadoVenta.OrderByDescending(h => h.FechaEstado))
                                {
                                    <li>@estado.EstadoVenta?.Descripcion (@estado.FechaEstado.ToString("g"))</li>
                                }
                            </ul>
                        }
                    </div>
                </div
            </div>
        </div>

        <div class="text-center mt-3">
            <button class="geex-btn--small-center" onclick="cerrarDetalle()">Cerrar</button>
        </div>
    </div>
</div>
